<?php

/* 
    myownradio.biz module
    section : user-size
    action  : getting list of streams
*/

$start_from = application::get("start", 0, REQ_INT);
$items_limit = 10;
$max_info_length = 512;
?>
<div class="page-stream-list -limit-width">
    <h1>ALL STREAMS</h1>
    <ul class="page-stream-list-list _ajax-upload-subject">
<?php 
$streams = stream::streamList($start_from, $items_limit);  
$tmpl = new Template("application/tmpl/us.streamitem.tmpl");
$cover_url = null;
foreach($streams as $stream): 
    $stream_instance = new radioStreamInfo($stream);
    $tmpl->reset();
    $tmpl->addVariable("stream_id", $stream_instance->getId());
    $tmpl->addVariable("stream_url", $stream_instance->getLink());
    $tmpl->addVariable("stream_title", $stream_instance->getName()->toUpperCase());
    $tmpl->addVariable("stream_info", (strlen($stream['info']) < $max_info_length) ? ($stream['info']) : (substr($stream['info'], 0, $max_info_length) . "..."));
    $tmpl->addVariable("stream_hashtags", layout::parseHashTags($stream['genres']), true);
    echo $tmpl->makeDocument();
endforeach; ?>
    </ul>
</div>